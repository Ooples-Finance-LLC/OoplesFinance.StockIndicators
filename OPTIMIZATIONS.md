# Sliding Window Optimization Inventory

Generated: 2026-01-03 11:18:09

This list focuses on O(N*K) candidates where a sliding window can reduce repeated sums/averages/min/max/median.

## Rolling Sum/Average (TakeLastExt + Sum/Average)

```
src\Calculations\BollingerBands.cs:166:            var x2Sma = x2List.TakeLastExt(length).Average();
src\Calculations\Chande.cs:89:            var diffSum = diffList.TakeLastExt(length).Sum();
src\Calculations\Chande.cs:90:            var absDiffSum = absDiffList.TakeLastExt(length).Sum();
src\Calculations\Chande.cs:145:            var denom = absDiffList.TakeLastExt(length).Sum();
src\Calculations\Chande.cs:194:            var diffSum1 = diffList.TakeLastExt(length1).Sum();
src\Calculations\Chande.cs:195:            var absSum1 = absDiffList.TakeLastExt(length1).Sum();
src\Calculations\Chande.cs:196:            var diffSum2 = diffList.TakeLastExt(length2).Sum();
src\Calculations\Chande.cs:197:            var absSum2 = absDiffList.TakeLastExt(length2).Sum();
src\Calculations\Chande.cs:198:            var diffSum3 = diffList.TakeLastExt(length3).Sum();
src\Calculations\Chande.cs:199:            var absSum3 = absDiffList.TakeLastExt(length3).Sum();
src\Calculations\Chande.cs:251:            var diffSum1 = diffList.TakeLastExt(length1).Sum();
src\Calculations\Chande.cs:252:            var absSum1 = absDiffList.TakeLastExt(length1).Sum();
src\Calculations\Chande.cs:253:            var diffSum2 = diffList.TakeLastExt(length2).Sum();
src\Calculations\Chande.cs:254:            var absSum2 = absDiffList.TakeLastExt(length2).Sum();
src\Calculations\Chande.cs:255:            var diffSum3 = diffList.TakeLastExt(length3).Sum();
src\Calculations\Chande.cs:256:            var absSum3 = absDiffList.TakeLastExt(length3).Sum();
src\Calculations\Chande.cs:318:            var cmo51 = valueDiff1List.TakeLastExt(length1).Sum();
src\Calculations\Chande.cs:319:            var cmo52 = valueDiff2List.TakeLastExt(length1).Sum();
src\Calculations\Chande.cs:320:            var cmo101 = valueDiff1List.TakeLastExt(length2).Sum();
src\Calculations\Chande.cs:321:            var cmo102 = valueDiff2List.TakeLastExt(length2).Sum();
src\Calculations\Chande.cs:322:            var cmo201 = valueDiff1List.TakeLastExt(length3).Sum();
src\Calculations\Chande.cs:323:            var cmo202 = valueDiff2List.TakeLastExt(length3).Sum();
src\Calculations\Chande.cs:352:            var s = dmiList.TakeLastExt(length1).Average();
src\Calculations\Chande.cs:638:            var upt = gainsList.TakeLastExt(length).Sum();
src\Calculations\Chande.cs:639:            var dnt = lossesList.TakeLastExt(length).Sum();
src\Calculations\Chande.cs:688:            var negSum = cmoNegChgList.TakeLastExt(length).Sum();
src\Calculations\Chande.cs:689:            var posSum = cmoPosChgList.TakeLastExt(length).Sum();
src\Calculations\Demark.cs:53:            var s1Sum = s1List.TakeLastExt(length).Sum();
src\Calculations\Demark.cs:54:            var s2Sum = s2List.TakeLastExt(length).Sum();
src\Calculations\Demark.cs:109:            var bpSum = bpList.TakeLastExt(length).Sum();
src\Calculations\Demark.cs:110:            var spSum = spList.TakeLastExt(length).Sum();
src\Calculations\Demark.cs:163:            var bpSum = bpList.TakeLastExt(length).Sum();
src\Calculations\Demark.cs:164:            var spSum = spList.TakeLastExt(length).Sum();
src\Calculations\Ehlers.cs:375:            var up2PoleChgSum = ssf2PoleUpChgList.TakeLastExt(length1).Sum();
src\Calculations\Ehlers.cs:376:            var down2PoleChgSum = ssf2PoleDownChgList.TakeLastExt(length1).Sum();
src\Calculations\Ehlers.cs:1022:            var upChgSum = upChgList.TakeLastExt(length3).Sum();
src\Calculations\Ehlers.cs:2083:            var filtPowMa = filtPowList.TakeLastExt(length2).Average();
src\Calculations\Ehlers.cs:2600:            var filtPowMa = filtPowList.TakeLastExt(length2).Average();
src\Calculations\Ehlers.cs:2721:            var squareAvg = squareList.TakeLastExt(length2).Average();
src\Calculations\Ehlers.cs:3084:            var sx = xList.TakeLastExt(length1).Sum();
src\Calculations\Ehlers.cs:3085:            var sy = yList.TakeLastExt(length1).Sum();
src\Calculations\Ehlers.cs:3086:            var sxx = xxList.TakeLastExt(length1).Sum();
src\Calculations\Ehlers.cs:3087:            var syy = yyList.TakeLastExt(length1).Sum();
src\Calculations\Ehlers.cs:3088:            var sxy = xyList.TakeLastExt(length1).Sum();
src\Calculations\Ehlers.cs:3470:            var avg = tempList.TakeLastExt(cycLength).Average();
src\Calculations\Ehlers.cs:3474:            var mdAvg = mdList.TakeLastExt(cycLength).Average();
src\Calculations\Ehlers.cs:6725:            var ratioSum = ratioList.TakeLastExt(length).Sum();
src\Calculations\Momentum.cs:157:            var sma = tempList.TakeLastExt(p).Average();
src\Calculations\Momentum.cs:163:            var amoms = amomList.TakeLastExt(signalLength).Average();
src\Calculations\Momentum.cs:580:            var avgGainSma = gainList.TakeLastExt(dmiLength).Average();
src\Calculations\Momentum.cs:581:            var avgLossSma = lossList.TakeLastExt(dmiLength).Average();
src\Calculations\Momentum.cs:588:            var dmiSignalSma = dmiSmaList.TakeLastExt(dmiLength).Average();
src\Calculations\Macd.cs:206:            var macdSignalLine = macdList.TakeLastExt(signalLength).Average();
src\Calculations\PriceChannel.cs:1032:            var cma = dPrice == 0 ? prevCma1 + (prevCma1 - prevCma2) : dPriceList.TakeLastExt(length).Average();
src\Calculations\PriceChannel.cs:1629:            var typicalSma = typicalList.TakeLastExt(length2).Average();
src\Calculations\PriceChannel.cs:1633:            var medianAvgSma = tempList.TakeLastExt(length1).Average();
src\Calculations\PriceChannel.cs:2686:            var squaredAvg = rocSquaredList.TakeLastExt(length).Average();
src\Calculations\PriceChannel.cs:2809:            var dev = Sqrt(sqList.TakeLastExt(fastLength).Average()) * mult;
src\Calculations\Ppo.cs:272:            var ppoSignalLine = ppoList.TakeLastExt(signalLength).Average();
src\Calculations\Rsi.cs:288:            var eAbsSma = eAbsList.TakeLastExt(length).Average();
src\Calculations\Rsi.cs:289:            var eSma = eList.TakeLastExt(length).Average();
src\Calculations\Rsi.cs:403:            var boVolume = tempList.TakeLastExt(lbLength).Sum();
src\Calculations\Rsi.cs:416:            var posPowerSum = posPowerList.TakeLastExt(length).Sum();
src\Calculations\Rsi.cs:417:            var negPowerSum = negPowerList.TakeLastExt(length).Sum();
src\Calculations\Rsi.cs:516:            var frsi = absRsiList.TakeLastExt(length).Sum();
src\Calculations\Rsi.cs:636:            var upChgSum = upChgList.TakeLastExt(length).Sum();
src\Calculations\Rsi.cs:637:            var downChgSum = downChgList.TakeLastExt(length).Sum();
src\Calculations\Rsi.cs:722:                b = avgRsiList.Count >= length ? avgRsiList.TakeLastExt(length).Average() : avgRsi;
src\Calculations\Oscillator.cs:180:            var squaredAvg = pctDrawdownSquaredList.TakeLastExt(length).Average();
src\Calculations\Oscillator.cs:537:            var bp7Sum = bpList.TakeLastExt(length1).Sum();
src\Calculations\Oscillator.cs:538:            var bp14Sum = bpList.TakeLastExt(length2).Sum();
src\Calculations\Oscillator.cs:539:            var bp28Sum = bpList.TakeLastExt(length3).Sum();
src\Calculations\Oscillator.cs:540:            var tr7Sum = trList.TakeLastExt(length1).Sum();
src\Calculations\Oscillator.cs:541:            var tr14Sum = trList.TakeLastExt(length2).Sum();
src\Calculations\Oscillator.cs:542:            var tr28Sum = trList.TakeLastExt(length3).Sum();
src\Calculations\Oscillator.cs:598:            var vmPlus14 = vmPlusList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:599:            var vmMinus14 = vmMinusList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:600:            var trueRange14 = trueRangeList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:1495:            var advSum = advancesList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:1496:            var decSum = declinesList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:1696:            var lcoSma1 = lcoList.TakeLastExt(length1).Average();
src\Calculations\Oscillator.cs:1699:            var lcoSma2 = lcoSma1List.TakeLastExt(length1).Average();
src\Calculations\Oscillator.cs:1757:            var probBbUpperUp = probBbUpperUpSeqList.TakeLastExt(length).Average();
src\Calculations\Oscillator.cs:1762:            var probBbUpperDown = probBbUpperDownSeqList.TakeLastExt(length).Average();
src\Calculations\Oscillator.cs:1769:            var probBbBasisUp = probBbBasisUpSeqList.TakeLastExt(length).Average();
src\Calculations\Oscillator.cs:1775:            var probBbBasisDown = probBbBasisDownSeqList.TakeLastExt(length).Average();
src\Calculations\Oscillator.cs:2147:            var advanceSum = advancesList.TakeLastExt(fastLength).Sum();
src\Calculations\Oscillator.cs:2150:            var declineSum = declinesList.TakeLastExt(fastLength).Sum();
src\Calculations\Oscillator.cs:2992:            var ibsi = ibsList.TakeLastExt(length).Average();
src\Calculations\Oscillator.cs:3179:            var emoSma = emoList.TakeLastExt(smaLength).Average();
src\Calculations\Oscillator.cs:3188:            var macdSma = tempMacdList.TakeLastExt(smaLength).Average();
src\Calculations\Oscillator.cs:3196:            var dpoSma = tempDpoList.TakeLastExt(smaLength).Average();
src\Calculations\Oscillator.cs:3207:            var rocSma = tempRocList.TakeLastExt(smaLength).Average();
src\Calculations\Oscillator.cs:3889:            var closeOpenSum = tempCloseOpenList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:3895:            var highLowSum = tempHighLowList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:4317:            var superGmmaOsc = superGmmaOscRawList.TakeLastExt(smoothLength).Average();
src\Calculations\Oscillator.cs:4460:            var bSum = bList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:4556:            var advSum = advList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:4557:            var loSum = loList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:4770:            var fastF1bSum = fastF1bList.TakeLastExt(fastLength).Sum();
src\Calculations\Oscillator.cs:4776:            var fastF2bSum = fastF2bList.TakeLastExt(fastLength).Sum();
src\Calculations\Oscillator.cs:4782:            var fastVWSum = fastVWList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:4787:            var slowF1bSum = slowF1bList.TakeLastExt(slowLength).Sum();
src\Calculations\Oscillator.cs:4793:            var slowF2bSum = slowF2bList.TakeLastExt(slowLength).Sum();
src\Calculations\Oscillator.cs:4799:            var slowVWSum = slowVWList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:5395:            var xp = sensitivity * (x1List.TakeLastExt(smoothLength).Average() - x2List.TakeLastExt(smoothLength).Average());
src\Calculations\Oscillator.cs:5401:            var xpAbsAvg = xpAbsList.TakeLastExt(length3).Average();
src\Calculations\Oscillator.cs:6059:            var gd120 = tempList.TakeLastExt(length1).Sum();
src\Calculations\Oscillator.cs:6061:            var gd121 = rangeList.TakeLastExt(length1).Sum();
src\Calculations\Oscillator.cs:6281:            var sk = fastKList.TakeLastExt(smoothLength).Average();
src\Calculations\Oscillator.cs:6913:            var col = aList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:7114:            var errSig = errSumList.TakeLastExt(soff).Average();
src\Calculations\Oscillator.cs:7115:            var value71 = value70List.TakeLastExt(length).Average();
src\Calculations\Oscillator.cs:7298:            var csiSma = csiList.TakeLastExt(length).Average();
src\Calculations\Oscillator.cs:7704:            var c2cSum = c2cList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:7985:            var condSum = condList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:8118:            var bullCountSum = bullCountList.TakeLastExt(length1).Sum();
src\Calculations\Oscillator.cs:8119:            var bearCountSum = bearCountList.TakeLastExt(length1).Sum();
src\Calculations\Oscillator.cs:9407:            var aSum = aList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:9408:            var dSum = dList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:9409:            var nSum = nList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:9547:                var rs3 = rs2 >= 5 || rs2 > rs2Ma ? xList.TakeLastExt(length4).Sum() / length4 * 100 : 0;
src\Calculations\Oscillator.cs:10065:            var req = chgXList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:10121:            var massIndex = ratioList.TakeLastExt(length3).Sum();
src\Calculations\Oscillator.cs:10181:            var advSum = advList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:10182:            var decSum = decList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:10190:            var advVolSum = advVolList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:10191:            var decVolSum = decVolList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:10487:            var len1Sum = tempList.TakeLastExt(fastLength - 1).Sum();
src\Calculations\Oscillator.cs:10488:            var len2Sum = tempList.TakeLastExt(slowLength - 1).Sum();
src\Calculations\Oscillator.cs:10659:            var advSum = advList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:10660:            var decSum = decList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:10668:            var advVolSum = advVolList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:10669:            var decVolSum = decVolList.TakeLastExt(length).Sum();
src\Calculations\Oscillator.cs:10882:            var s1Sma = s1List.TakeLastExt(length2).Average();
src\Calculations\Oscillator.cs:11358:            var sk = stoRsiList.TakeLastExt(length3).Average();
src\Calculations\Oscillator.cs:11361:            var sd = skList.TakeLastExt(length4).Average();
src\Calculations\Oscillator.cs:11916:            var aboveSum = aboveList.TakeLastExt(length2).Sum();
src\Calculations\MovingAvg.cs:170:            var volatilitySum = volatilityList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:688:            var volumePriceSma = volumePriceList.TakeLastExt(length).Average();
src\Calculations\MovingAvg.cs:747:            var posMoneyFlowTotal = posMoneyFlowList.TakeLastExt(len).Sum();
src\Calculations\MovingAvg.cs:748:            var negMoneyFlowTotal = negMoneyFlowList.TakeLastExt(len).Sum();
src\Calculations\MovingAvg.cs:1055:            var ma1 = cList.TakeLastExt(length).Average();
src\Calculations\MovingAvg.cs:1058:            var mad = ma1List.TakeLastExt(length).Average();
src\Calculations\MovingAvg.cs:1131:            var atrValSum = tempList.TakeLastExt(stdDevLength).Sum();
src\Calculations\MovingAvg.cs:1925:            var bartlettWSum = bartlettWList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:1929:            var bartlettVWSum = bartlettVWList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:1938:            var blackmanWSum = blackmanWList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:1942:            var blackmanVWSum = blackmanVWList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:1950:            var hanningWSum = hanningWList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:1954:            var hanningVWSum = hanningVWList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:2143:            var powSma = powList.TakeLastExt(length).Average();
src\Calculations\MovingAvg.cs:2377:            var ySum = tempList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:2380:            var x1Sum = x1List.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:2383:            var x2Sum = x2List.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:2386:            var x1x2Sum = x1x2List.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:2389:            var yx1Sum = yx1List.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:2392:            var yx2Sum = yx2List.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:2395:            var x2PowSum = x2PowList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:2966:            var bSma = bList.TakeLastExt(length1).Average();
src\Calculations\MovingAvg.cs:3753:            var e = absDiffList.TakeLastExt(length).Average();
src\Calculations\MovingAvg.cs:3754:            var z = e != 0 ? diffList.TakeLastExt(length).Average() / e : 0;
src\Calculations\MovingAvg.cs:3913:            var volumeRatioSum = volumeRatioList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:3916:            var priceVolumeRatioSum = priceVolumeRatioList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:4247:            var denominator = changeList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:4679:            var wSum1 = w1List.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:4680:            var wSum2 = w2List.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:4681:            var sum1 = vw1List.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:4682:            var sum2 = vw2List.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:4965:            var x2Avg = (double)x2LbList.TakeLastExt(length).Average();
src\Calculations\MovingAvg.cs:4971:            var x2PowAvg = x2PowList.TakeLastExt(length).Average();
src\Calculations\MovingAvg.cs:5419:            var sumX = xList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:5420:            var sumY = yList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:5421:            var sumXY = xyList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:5422:            var sumX2 = x2List.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:6002:            var srcSma = srcList.TakeLastExt(length).Average();
src\Calculations\MovingAvg.cs:6006:            var srcStdDev = Sqrt(srcDevList.TakeLastExt(length).Average());
src\Calculations\MovingAvg.cs:6624:            var sum = signList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:6811:            var volumeSum = tempList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:6867:            var req = chgXList.TakeLastExt(length).Sum();
src\Calculations\MovingAvg.cs:8092:            var filtPowMa = filtPowList.TakeLastExt(length2).Average();
src\Calculations\MovingAvg.cs:8197:            var shortMa = shortPowList.TakeLastExt(fastLength).Average();
src\Calculations\MovingAvg.cs:8203:            var longMa = longPowList.TakeLastExt(slowLength).Average();
src\Calculations\Ratio.cs:369:            var retSma = retList.TakeLastExt(length).Average();
src\Calculations\Ratio.cs:541:            var highSum = tempHighList.TakeLastExt(length).Sum();
src\Calculations\Ratio.cs:542:            var lowSum = tempLowList.TakeLastExt(length).Sum();
src\Calculations\Ratio.cs:543:            var openSum = openList.TakeLastExt(length).Sum();
src\Calculations\Ratio.cs:544:            var prevCloseSum = prevCloseList.TakeLastExt(length).Sum();
src\Calculations\Stochastic.cs:309:            var numSum = numList.TakeLastExt(smoothLength).Sum();
src\Calculations\Stochastic.cs:310:            var denomSum = denomList.TakeLastExt(smoothLength).Sum();
src\Calculations\Trend.cs:90:            var ctrPSum = ctrPList.TakeLastExt(length).Sum();
src\Calculations\Trend.cs:91:            var ctrMSum = ctrMList.TakeLastExt(length).Sum();
src\Calculations\Trend.cs:557:            var sdPlus = deviationUpList.TakeLastExt(fastLength).Sum();
src\Calculations\Trend.cs:558:            var sdMinus = deviationDownList.TakeLastExt(fastLength).Sum();
src\Calculations\Trend.cs:672:            var tdiDirection = momList.TakeLastExt(length1).Sum();
src\Calculations\Trend.cs:675:            var momAbsSum1 = momAbsList.TakeLastExt(length1).Sum();
src\Calculations\Trend.cs:676:            var momAbsSum2 = momAbsList.TakeLastExt(length2).Sum();
src\Calculations\Trend.cs:738:            var tcfPlus = diffPlusList.TakeLastExt(length).Sum();
src\Calculations\Trend.cs:742:            var tcfMinus = diffMinusList.TakeLastExt(length).Sum();
src\Calculations\Trend.cs:902:            var advSum = advList.TakeLastExt(length).Sum();
src\Calculations\Trend.cs:903:            var decSum = decList.TakeLastExt(length).Sum();
src\Calculations\Trend.cs:911:            var advVolSum = advVolList.TakeLastExt(length).Sum();
src\Calculations\Trend.cs:912:            var decVolSum = decVolList.TakeLastExt(length).Sum();
src\Calculations\Trend.cs:1132:            var trend = tList.TakeLastExt(length).Average();
src\Calculations\Trend.cs:1141:            var diffSma = diffList.TakeLastExt(forecastLength).Average();
src\Calculations\Volatility.cs:369:            var bSum = bList.TakeLastExt(length).Sum();
src\Calculations\Volatility.cs:583:            var trSum = trList.TakeLastExt(length).Sum();
src\Calculations\Volatility.cs:630:            var uvi = (double)1 / length * absList.TakeLastExt(length).Sum();
src\Calculations\Volatility.cs:722:            var logSum = logList.TakeLastExt(length).Sum();
src\Calculations\Volatility.cs:841:            var avgLog = tempLogList.TakeLastExt(length).Average();
src\Calculations\Volatility.cs:845:            var devLogSqAvg = devLogSqList.TakeLastExt(length).Sum() / (length - 1);
src\Calculations\Volatility.cs:1014:            var denominator = changeList.TakeLastExt(length).Sum();
src\Calculations\Volatility.cs:1076:            var a = tempHighList.TakeLastExt(length).Sum();
src\Calculations\Volatility.cs:1077:            var b = tempLowList.TakeLastExt(length).Sum();
src\Calculations\Volatility.cs:1345:            var sum = tempList.TakeLastExt(length).Sum();
src\Calculations\TrailingStop.cs:922:            var countM = dmMinusCountList.TakeLastExt(length2).Sum();
src\Calculations\TrailingStop.cs:923:            var dmMinusSum = dmMinusList.TakeLastExt(length2).Sum();
src\Calculations\TrailingStop.cs:925:            var countP = dmPlusCountList.TakeLastExt(length2).Sum();
src\Calculations\TrailingStop.cs:926:            var dmPlusSum = dmPlusList.TakeLastExt(length2).Sum();
src\Calculations\Volume.cs:90:            var posMoneyFlowTotal = posMoneyFlowList.TakeLastExt(length).Sum();
src\Calculations\Volume.cs:91:            var negMoneyFlowTotal = negMoneyFlowList.TakeLastExt(length).Sum();
src\Calculations\Volume.cs:379:            var volumeSum = tempVolumeList.TakeLastExt(length).Sum();
src\Calculations\Volume.cs:380:            var mfVolumeSum = moneyFlowVolumeList.TakeLastExt(length).Sum();
src\Calculations\Volume.cs:706:            var fastBuffNum = priceVolList.TakeLastExt(fastLength).Sum();
src\Calculations\Volume.cs:707:            var fastBuffDenom = tempVolumeList.TakeLastExt(fastLength).Sum();
src\Calculations\Volume.cs:713:            var slowBuffNum = priceVolList.TakeLastExt(slowLength).Sum();
src\Calculations\Volume.cs:714:            var slowBuffDenom = tempVolumeList.TakeLastExt(slowLength).Sum();
src\Calculations\Volume.cs:762:            var upVolSum = upVolList.TakeLastExt(length).Sum();
src\Calculations\Volume.cs:763:            var downVolSum = downVolList.TakeLastExt(length).Sum();
src\Calculations\Volume.cs:1106:            var volumeSma = tempVolumeList.TakeLastExt(length).Average();
src\Calculations\Volume.cs:1107:            var rangeSma = tempRangeList.TakeLastExt(length).Average();
src\Calculations\Volume.cs:1355:            var avf = vBymList.TakeLastExt(length).Average();
src\Calculations\Volume.cs:1494:            var vn = vmnList.TakeLastExt(length).Sum();
src\Calculations\Volume.cs:1495:            var vp = vmpList.TakeLastExt(length).Sum();
src\Calculations\Volume.cs:1548:            var vaoSum = vaoList.TakeLastExt(length).Average();
src\Calculations\Volume.cs:1593:            var volumeSum = tempVolumeList.TakeLastExt(length).Sum();
src\Calculations\Volume.cs:1594:            var tvaSum = tvaList.TakeLastExt(length).Sum();
src\Calculations\Volume.cs:1673:            var vcpSum = vcpList.TakeLastExt(length1).Sum();
src\Calculations\Volume.cs:1743:            var aSum = aList.TakeLastExt(length1).Sum();
src\Calculations\Volume.cs:1744:            var bSum = bList.TakeLastExt(length2).Sum();
src\Calculations\Volume.cs:1745:            var absASum = absAList.TakeLastExt(length1).Sum();
src\Calculations\Volume.cs:1746:            var absBSum = absBList.TakeLastExt(length2).Sum();
src\Calculations\Volume.cs:1954:            var totvSum = totvList.TakeLastExt(length).Sum();
```

## Rolling Min/Max (TakeLastExt + Min/Max)

```
src\Calculations\BollingerBands.cs:175:            var aMax = aList.TakeLastExt(length).Max();
src\Calculations\BollingerBands.cs:178:            var bMin = bList.TakeLastExt(length).Min();
src\Calculations\Ehlers.cs:6130:            var env = absDerList.TakeLastExt(length1).Max();
src\Calculations\Ratio.cs:322:            var maxDd = ddList.TakeLastExt(length).Min();
src\Calculations\Oscillator.cs:4926:            var mm = wwList.TakeLastExt(smoothLength).Max();
src\Calculations\Oscillator.cs:6273:            var lowestRbc = rbcList.TakeLastExt(length2).Min();
src\Calculations\Oscillator.cs:8182:            var smoSmaHighest = smoSmaList.TakeLastExt(length).Max();
src\Calculations\Oscillator.cs:8183:            var smoSmaLowest = smoSmaList.TakeLastExt(length).Min();
src\Calculations\Oscillator.cs:8184:            var smoHighest = smoList.TakeLastExt(length).Max();
src\Calculations\Oscillator.cs:8185:            var smoLowest = smoList.TakeLastExt(length).Min();
src\Calculations\MovingAvg.cs:1137:            var stdDevLow = stdDevList.TakeLastExt(lbLength).Min();
src\Calculations\MovingAvg.cs:1200:            var highest = tempList.TakeLastExt(length).Max();
src\Calculations\MovingAvg.cs:2969:            var highest = bSmaList.TakeLastExt(length).Max();
src\Calculations\Rsi.cs:1090:            var lowestX1 = tempRsi21List.TakeLastExt(length2).Min();
src\Calculations\Rsi.cs:1091:            var lowestZ1 = tempRsi21List.TakeLastExt(length3).Min();
src\Calculations\Rsi.cs:1092:            var highestY1 = tempRsi21List.TakeLastExt(length3).Max();
src\Calculations\Rsi.cs:1093:            var lowestX2 = tempRsi21List.TakeLastExt(length5).Min();
src\Calculations\Rsi.cs:1094:            var lowestZ2 = tempRsi21List.TakeLastExt(length5).Min();
src\Calculations\Rsi.cs:1095:            var highestY2 = tempRsi21List.TakeLastExt(length5).Max();
src\Calculations\Rsi.cs:1096:            var lowestX3 = tempRsi14List.TakeLastExt(length4).Min();
src\Calculations\Rsi.cs:1097:            var lowestZ3 = tempRsi14List.TakeLastExt(length4).Min();
src\Calculations\Rsi.cs:1098:            var highestY3 = tempRsi14List.TakeLastExt(length4).Max();
src\Calculations\Rsi.cs:1099:            var lowestX4 = tempRsi21List.TakeLastExt(length3).Min();
src\Calculations\Rsi.cs:1100:            var lowestZ4 = tempRsi21List.TakeLastExt(length3).Min();
src\Calculations\Rsi.cs:1101:            var highestY4 = tempRsi21List.TakeLastExt(length2).Max();
src\Calculations\Rsi.cs:1102:            var lowestX5 = tempRsi5List.TakeLastExt(length1).Min();
src\Calculations\Rsi.cs:1103:            var lowestZ5 = tempRsi5List.TakeLastExt(length1).Min();
src\Calculations\Rsi.cs:1104:            var highestY5 = tempRsi5List.TakeLastExt(length1).Max();
src\Calculations\Rsi.cs:1105:            var lowestX6 = tempRsi13List.TakeLastExt(length3).Min();
src\Calculations\Rsi.cs:1106:            var lowestZ6 = tempRsi13List.TakeLastExt(length3).Min();
src\Calculations\Rsi.cs:1107:            var highestY6 = tempRsi13List.TakeLastExt(length3).Max();
src\Calculations\Rsi.cs:1108:            var lowestCustom = tempRsi8List.TakeLastExt(length2).Min();
src\Calculations\Rsi.cs:1109:            var highestCustom = tempRsi8List.TakeLastExt(length2).Max();
src\Calculations\TrailingStop.cs:935:            var highest = safeZMinusList.TakeLastExt(length3).Max();
src\Calculations\TrailingStop.cs:936:            var lowest = safeZPlusList.TakeLastExt(length3).Min();
src\Helpers\CalculationsHelper.cs:793:            var highest = tempHighList.TakeLastExt(length).Max();
src\Helpers\CalculationsHelper.cs:796:            var lowest = tempLowList.TakeLastExt(length).Min();
src\Calculations\Trend.cs:505:            var tdfh = absTdfList.TakeLastExt(length2).Max();
src\Calculations\Volume.cs:640:            var c1 = v3 == v3List.TakeLastExt(length).Min();
src\Calculations\Volume.cs:641:            var c2 = v4 == v4List.TakeLastExt(length).Max() && currentClose > currentOpen;
src\Calculations\Volume.cs:642:            var c3 = v5 == v5List.TakeLastExt(length).Max() && currentClose > currentOpen;
src\Calculations\Volume.cs:643:            var c4 = v6 == v6List.TakeLastExt(length).Max() && currentClose < currentOpen;
src\Calculations\Volume.cs:644:            var c5 = v7 == v7List.TakeLastExt(length).Max() && currentClose < currentOpen;
src\Calculations\Volume.cs:645:            var c6 = v8 == v8List.TakeLastExt(length).Min() && currentClose < currentOpen;
src\Calculations\Volume.cs:646:            var c7 = v9 == v9List.TakeLastExt(length).Min() && currentClose < currentOpen;
src\Calculations\Volume.cs:647:            var c8 = v10 == v10List.TakeLastExt(length).Min() && currentClose > currentOpen;
src\Calculations\Volume.cs:648:            var c9 = v11 == v11List.TakeLastExt(length).Min() && currentClose > currentOpen;
src\Calculations\Volume.cs:649:            var c10 = v12 == v12List.TakeLastExt(length).Max();
src\Calculations\Volume.cs:650:            var c11 = v13 == v13List.TakeLastExt(length).Min() && currentClose > currentOpen && prevClose > prevOpen;
src\Calculations\Volume.cs:651:            var c12 = v14 == v14List.TakeLastExt(length).Max() && currentClose > currentOpen && prevClose > prevOpen;
src\Calculations\Volume.cs:652:            var c13 = v15 == v15List.TakeLastExt(length).Max() && currentClose > currentOpen && prevClose < prevOpen;
src\Calculations\Volume.cs:653:            var c14 = v16 == v16List.TakeLastExt(length).Min() && currentClose < currentOpen && prevClose < prevOpen;
src\Calculations\Volume.cs:654:            var c15 = v17 == v17List.TakeLastExt(length).Min() && currentClose < currentOpen && prevClose < prevOpen;
src\Calculations\Volume.cs:655:            var c16 = v18 == v18List.TakeLastExt(length).Min() && currentClose < currentOpen && prevClose < prevOpen;
src\Calculations\Volume.cs:656:            var c17 = v19 == v19List.TakeLastExt(length).Min() && currentClose > currentOpen && prevClose < prevOpen;
src\Calculations\Volume.cs:657:            var c18 = v20 == v20List.TakeLastExt(length).Min() && currentClose > currentOpen && prevClose > prevOpen;
src\Calculations\Volume.cs:658:            var c19 = v21 == v21List.TakeLastExt(length).Min() && currentClose > currentOpen && prevClose > prevOpen;
src\Calculations\Volume.cs:659:            var c20 = v22 == v22List.TakeLastExt(length).Min();
```

## Rolling Median (TakeLastExt + Median)

```
src\Calculations\Ehlers.cs:192:            var medianDelta = dpList.TakeLastExt(length).Median();
src\Calculations\Ehlers.cs:1464:            var domCyc = dcList.TakeLastExt(length2).Median();
src\Calculations\Ehlers.cs:2655:            var median = tempList.TakeLastExt(length1).Median();
src\Calculations\MovingAvg.cs:3423:            var sampleMedian = tempList.TakeLastExt(length).Median();
src\Calculations\MovingAvg.cs:3427:            var mad = absDiffList.TakeLastExt(length).Median();
src\Calculations\MovingAvg.cs:5569:                var value1 = smthList.TakeLastExt(len).Median();
src\Calculations\MovingAvg.cs:7336:            var median = tempList.TakeLastExt(length1).Median();
src\Calculations\MovingAvg.cs:7601:            var alpha = mid != 0 ? midList.TakeLastExt(length2).Median() : prevAlpha;
src\Calculations\Volatility.cs:504:            var median = tempList.TakeLastExt(length).Median();
```

## Other TakeLastExt Usages (potential rolling window or allocation)

```
src\Calculations\Chande.cs:449:            var r2 = GoodnessOfFit.RSquared(indexList.TakeLastExt(length).Select(x => (double)x),
src\Calculations\Chande.cs:450:                tempValueList.TakeLastExt(length).Select(x => (double)x));
src\Calculations\MovingAvg.cs:1384:            var corr = GoodnessOfFit.R(tempList.TakeLastExt(length).Select(x => (double)x), xList.TakeLastExt(length).Select(x => (double)x));
src\Calculations\MovingAvg.cs:1533:            var corr = GoodnessOfFit.R(indexList.TakeLastExt(length).Select(x => (double)x), tempList.TakeLastExt(length).Select(x => (double)x));
src\Calculations\MovingAvg.cs:2666:            var corr = GoodnessOfFit.R(yList.TakeLastExt(length).Select(x => (double)x), xList.TakeLastExt(length).Select(x => (double)x));
src\Calculations\MovingAvg.cs:2824:            var lookBackList = tempList.TakeLastExt(length);
src\Calculations\MovingAvg.cs:2880:            var corr = GoodnessOfFit.R(tempList.TakeLastExt(length).Select(x => (double)x), prevOwmaList.TakeLastExt(length).Select(x => (double)x));
src\Calculations\MovingAvg.cs:2940:            var corr = GoodnessOfFit.R(indexList.TakeLastExt(length).Select(x => (double)x), tempList.TakeLastExt(length).Select(x => (double)x));
src\Calculations\MovingAvg.cs:3685:            var lbList = tempList.TakeLastExt(length).ToList();
src\Calculations\MovingAvg.cs:4117:            var lbList = isList.TakeLastExt(length).ToList();
src\Calculations\MovingAvg.cs:4837:            var corr = GoodnessOfFit.R(bList.TakeLastExt(length).Select(x => (double)x), tempList.TakeLastExt(length).Select(x => (double)x));
src\Calculations\MovingAvg.cs:4955:            var lbList = tempList.TakeLastExt(length).Select(x => (double)x);
src\Calculations\MovingAvg.cs:4962:            var x2LbList = x2List.TakeLastExt(length).Select(x => (double)x).ToList();
src\Calculations\MovingAvg.cs:4979:            var ry1 = Math.Pow(GoodnessOfFit.R(y1List.TakeLastExt(length).Select(x => (double)x), lbList), 2);
src\Calculations\MovingAvg.cs:4981:            var ry2 = Math.Pow(GoodnessOfFit.R(y2List.TakeLastExt(length).Select(x => (double)x), lbList), 2);
src\Calculations\MovingAvg.cs:7593:            var list = diffList.TakeLastExt(length1).ToList();
src\Calculations\PriceChannel.cs:1274:            var stdError = GoodnessOfFit.PopulationStandardError(tempLinRegList.TakeLastExt(length2).Select(x => (double)x),
src\Calculations\PriceChannel.cs:1275:                tempInputList.TakeLastExt(length2).Select(x => (double)x));
src\Calculations\PriceChannel.cs:1963:            var corr = GoodnessOfFit.R(indexList.TakeLastExt(length2).Select(x => (double)x), tempList.TakeLastExt(length2).Select(x => (double)x));
src\Calculations\Oscillator.cs:2727:            var corr = GoodnessOfFit.R(indexList.TakeLastExt(length).Select(x => (double)x), tempList.TakeLastExt(length).Select(x => (double)x));
src\Calculations\Oscillator.cs:5867:            var pearsonCorrelation = Correlation.Pearson(tempLinRegList.TakeLastExt(length).Select(x => (double)x),
src\Calculations\Oscillator.cs:5868:                tempList.TakeLastExt(length).Select(x => (double)x));
src\Calculations\Oscillator.cs:5999:                var list = dList.TakeLastExt(length).ToList();
src\Calculations\Oscillator.cs:6497:            var dvo = MinOrMax((double)tempList.TakeLastExt(length).Where(i => i <= a).Count() / length * 100, 100, 0);
src\Calculations\Oscillator.cs:8907:            var lbList = v1List.TakeLastExt(length).ToList();
src\Calculations\Oscillator.cs:9739:            var lbList = absChgList.TakeLastExt(length).ToList();
src\Calculations\Oscillator.cs:9849:            var corr = GoodnessOfFit.R(indexList.TakeLastExt(length).Select(x => (double)x), tempList.TakeLastExt(length).Select(x => (double)x));
src\Calculations\Oscillator.cs:11663:            var enumerableList = tempList.TakeLastExt(length).Select(x => (double)x);
src\Calculations\Rsi.cs:116:            var lookBackList = tempList.TakeLastExt(length3).Take(length3 - 1).ToList();
src\Calculations\Rsi.cs:183:            double upCount = rocList.TakeLastExt(length).Where(x => x >= 0).Count();
src\Helpers\CalculationsHelper.cs:758:            var list = inputList.TakeLastExt(Math.Max(length, 2)).ToList();
src\Calculations\Stochastic.cs:562:            var lbList = maList.TakeLastExt(length).ToList();
src\Calculations\Volatility.cs:851:            double count = hvList.TakeLastExt(annualLength).Where(i => i < hv).Count();
src\Calculations\Volatility.cs:1589:            var corr = GoodnessOfFit.R(prevList.TakeLastExt(length).Select(x => (double)x), tempList.TakeLastExt(length).Select(x => (double)x));
src\Calculations\Volume.cs:490:            var list = rList.TakeLastExt(length).ToList();
src\Calculations\Volume.cs:1343:            var list = aMoveList.TakeLastExt(length).ToList();
src\Calculations\Volume.cs:1347:            var tList = tempList.TakeLastExt(length).ToList();
```

